{"version":3,"sources":["gwas-credible-sets.min.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","ninv","a","b","e","f","q","r","x","Math","abs","sqrt","log","value","rollup","default","_interopRequireDefault","obj","marking","stats","scoring","undefined","_stats2","_scoring2","_marking2","_nlogp_to_z2","nlogp","pow","_stats","bayesFactors","nlogpvals","cap","arguments","length","Array","isArray","z2_2","map","item","capValue","max","apply","arr","arr2","from","_toConsumableArray","exp","posteriorProbabilities","scores","sumValues","reduce","findCredibleSet","statistics","cutoff","Number","isNaN","statsTotal","sortedStatsMap","index","sort","runningTotal","result","fill","_sortedStatsMap$i","_slicedToArray","score","markCredibleSetBoolean","markCredibleSetScaled","setMemberScores","sumMarkers","Symbol","iterator","_arr","_n","_d","_e","_s","_i","next","done","push","err","sliceIterator","TypeError"],"mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,UAAWH,GACe,iBAAZC,QACdA,QAA0B,iBAAID,IAE9BD,EAAuB,iBAAIC,IAR7B,CASGK,KAAM,WACT,OAAgB,SAAUC,GAKhB,SAASC,EAAoBC,GAG5B,GAAGC,EAAiBD,GACnB,OAAOC,EAAiBD,GAAUP,QAGnC,IAAIC,EAASO,EAAiBD,IAC7BE,EAAGF,EACHG,GAAG,EACHV,YAUD,OANAK,EAAQE,GAAUI,KAAKV,EAAOD,QAASC,EAAQA,EAAOD,QAASM,GAG/DL,EAAOS,GAAI,EAGJT,EAAOD,QAvBf,IAAIQ,KA4DJ,OAhCAF,EAAoBM,EAAIP,EAGxBC,EAAoBO,EAAIL,EAGxBF,EAAoBQ,EAAI,SAASd,EAASe,EAAMC,GAC3CV,EAAoBW,EAAEjB,EAASe,IAClCG,OAAOC,eAAenB,EAASe,GAC9BK,cAAc,EACdC,YAAY,EACZC,IAAKN,KAMRV,EAAoBiB,EAAI,SAAStB,GAChC,IAAIe,EAASf,GAAUA,EAAOuB,WAC7B,WAAwB,OAAOvB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAK,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASQ,EAAQC,GAAY,OAAOR,OAAOS,UAAUC,eAAejB,KAAKc,EAAQC,IAGzGpB,EAAoBuB,EAAI,GAGjBvB,EAAoBA,EAAoBwB,EAAI,GA9D7C,EAmEV,SAAU7B,EAAQD,EAASM,GAEjC,aAgBA,SAASyB,EAAKF,GACV,IAIIG,GAAK,mBAAyB,mBAAyB,mBAAyB,kBAAyB,kBAAyB,iBAAyB,kBAAyB,oBAEpLC,GAAK,kBAAyB,kBAAyB,kBAAyB,mBAAyB,kBAAyB,mBAAyB,mBAE3JpB,GAAK,mBAA0B,kBAA0B,kBAA0B,mBAA0B,mBAA0B,kBAA2B,oBAA2B,sBAE7LC,GAAK,kBAA0B,mBAA0B,eAA2B,mBAA2B,oBAA2B,qBAA2B,uBAErKoB,GAAK,kBAA0B,kBAA0B,mBAA0B,mBAA2B,oBAA2B,qBAA2B,sBAA2B,uBAE/LC,GAAK,iBAA2B,kBAA2B,oBAA2B,qBAA2B,sBAA2B,qBAA2B,wBAEvKC,EAAIP,EAAI,GACRQ,OAAI,EACJC,OAAI,EAER,GAAIC,KAAKC,IAAIJ,GApBA,KAsBT,OADAC,EAnBS,QAmBID,EAAIA,EACVA,SAAWJ,EAAE,GAAKK,EAAIL,EAAE,IAAMK,EAAIL,EAAE,IAAMK,EAAIL,EAAE,IAAMK,EAAIL,EAAE,IAAMK,EAAIL,EAAE,IAAMK,EAAIL,EAAE,IAAMK,EAAIL,EAAE,WAAaC,EAAE,GAAKI,EAAIJ,EAAE,IAAMI,EAAIJ,EAAE,IAAMI,EAAIJ,EAAE,IAAMI,EAAIJ,EAAE,IAAMI,EAAIJ,EAAE,IAAMI,EAAIJ,EAAE,IAAMI,EAAI,GAQvM,MALIA,EADAD,EAAI,EACAP,EAEA,EAAMA,GAGN,GAUJ,KAAM,kBAOV,OAbQS,GAHJD,EAAIE,KAAKE,MAAMF,KAAKG,IAAIL,MA9BnB,SAiCUxB,EAAE,IADbwB,GA9BC,KA+BqBxB,EAAE,IAAMwB,EAAIxB,EAAE,IAAMwB,EAAIxB,EAAE,IAAMwB,EAAIxB,EAAE,IAAMwB,EAAIxB,EAAE,IAAMwB,EAAIxB,EAAE,IAAMwB,EAAIxB,EAAE,WAAaC,EAAE,GAAKuB,EAAIvB,EAAE,IAAMuB,EAAIvB,EAAE,IAAMuB,EAAIvB,EAAE,IAAMuB,EAAIvB,EAAE,IAAMuB,EAAIvB,EAAE,IAAMuB,EAAIvB,EAAE,IAAMuB,EAAI,UAGrLH,EAAE,IADbG,GAnCC,GAoCqBH,EAAE,IAAMG,EAAIH,EAAE,IAAMG,EAAIH,EAAE,IAAMG,EAAIH,EAAE,IAAMG,EAAIH,EAAE,IAAMG,EAAIH,EAAE,IAAMG,EAAIH,EAAE,WAAaC,EAAE,GAAKE,EAAIF,EAAE,IAAME,EAAIF,EAAE,IAAME,EAAIF,EAAE,IAAME,EAAIF,EAAE,IAAME,EAAIF,EAAE,IAAME,EAAIF,EAAE,IAAME,EAAI,GAMpMD,EAAI,IACJE,GAAKA,GAGFA,EA7DfpB,OAAOC,eAAenB,EAAS,cAC3B2C,OAAO,IAiEX,IAAIC,GAAWb,KAAMA,GAErB/B,EAAQ+B,KAAOA,EACf/B,EAAQ6C,QAAUD,GAIZ,SAAU3C,EAAQD,EAASM,GAEjC,aAoBA,SAASwC,EAAuBC,GAAO,OAAOA,GAAOA,EAAIvB,WAAauB,GAAQF,QAASE,GAjBvF7B,OAAOC,eAAenB,EAAS,cAC7B2C,OAAO,IAET3C,EAAQgD,QAAUhD,EAAQiD,MAAQjD,EAAQkD,aAAUC,EAEpD,IAEIC,EAAUN,EAFDxC,EAAoB,IAM7B+C,EAAYP,EAFDxC,EAAoB,IAM/BgD,EAAYR,EAFDxC,EAAoB,IAYnCN,EAAQkD,QAAUG,EAAUR,QAC5B7C,EAAQiD,MAAQG,EAAQP,QACxB7C,EAAQgD,QAAUM,EAAUT,SAItB,SAAU5C,EAAQD,EAASM,GAEjC,aAwBA,SAASiD,EAAaC,GAClB,IAAI3B,EAAIU,KAAKkB,IAAI,IAAKD,GACtB,OAAIA,EAAQ,IAEDjB,KAAKkB,KAAI,EAAIC,EAAO3B,MAAMF,EAAI,GAAI,GAKlC,iBAAmB2B,EAAQ,iBAY1C,SAASG,EAAaC,GAClB,IAAIC,IAAMC,UAAUC,OAAS,QAAsBZ,IAAjBW,UAAU,KAAmBA,UAAU,GAEzE,IAAKE,MAAMC,QAAQL,KAAeA,EAAUG,OACxC,KAAM,4CAMV,IAAIG,EAAON,EAAUO,IAAI,SAAUC,GAC/B,OAAOb,EAAaa,GAAQ,IAMhC,GAAIP,EAAK,CACL,IAAIQ,EAAW9B,KAAK+B,IAAIC,MAAMhC,KArDtC,SAA4BiC,GAAO,GAAIR,MAAMC,QAAQO,GAAM,CAAE,IAAK,IAAI/D,EAAI,EAAGgE,EAAOT,MAAMQ,EAAIT,QAAStD,EAAI+D,EAAIT,OAAQtD,IAAOgE,EAAKhE,GAAK+D,EAAI/D,GAAM,OAAOgE,EAAe,OAAOT,MAAMU,KAAKF,GAqD9IG,CAAmBT,IAAS,IAC5DG,EAAW,IACXH,EAAOA,EAAKC,IAAI,SAAUC,GACtB,OAAOA,EAAOC,KAI1B,OAAOH,EAAKC,IAAI,SAAUC,GACtB,OAAO7B,KAAKqC,IAAIR,KAaxB,SAASS,EAAuBC,GAC5B,IAAIC,EAAYD,EAAOE,OAAO,SAAUhD,EAAGC,GACvC,OAAOD,EAAIC,GACZ,GACH,OAAO6C,EAAOX,IAAI,SAAUC,GACxB,OAAOA,EAAOW,IAtFtB7D,OAAOC,eAAenB,EAAS,cAC3B2C,OAAO,IAEX3C,EAAQuD,aAAevD,EAAQ6E,uBAAyB7E,EAAQ2D,kBAAeR,EAE/E,IAAIO,EAASpD,EAAoB,GAqF7BsC,GAAWe,aAAcA,EAAckB,uBAAwBA,GACnE7E,EAAQ6C,QAAUD,EAClB5C,EAAQ2D,aAAeA,EACvB3D,EAAQ6E,uBAAyBA,EAIjC7E,EAAQuD,aAAeA,GAIjB,SAAUtD,EAAQD,EAASM,GAEjC,aAoBA,SAAS2E,EAAgBC,GACrB,IAAIC,EAASrB,UAAUC,OAAS,QAAsBZ,IAAjBW,UAAU,GAAmBA,UAAU,GAAK,IAGjF,IAAKE,MAAMC,QAAQiB,KAAgBA,EAAWnB,OAC1C,KAAM,uCAEV,GAAwB,iBAAXoB,GAAwBA,EAAS,GAAKA,EAAS,GAAOC,OAAOC,MAAMF,GAC5E,KAAM,0CAGV,IAAIG,EAAaJ,EAAWF,OAAO,SAAUhD,EAAGC,GAC5C,OAAOD,EAAIC,GACZ,GACH,GAAIqD,GAAc,EACd,KAAM,yCAYV,IAAK,IARDC,EAAiBL,EAAWf,IAAI,SAAUC,EAAMoB,GAChD,OAAQpB,EAAMoB,KACfC,KAAK,SAAUzD,EAAGC,GACjB,OAAOA,EAAE,GAAKD,EAAE,KAGhB0D,EAAe,EACfC,EAAS,IAAI3B,MAAMuB,EAAexB,QAAQ6B,KAAK,GAC1CnF,EAAI,EAAGA,EAAI8E,EAAexB,OAAQtD,IAAK,CAC5C,IAAIoF,EAAoBC,EAAeP,EAAe9E,GAAI,GACtDkC,EAAQkD,EAAkB,GAC1BL,EAAQK,EAAkB,GAE9B,KAAIH,EAAeP,GAOf,MAJA,IAAIY,EAAQpD,EAAQ2C,EACpBK,EAAOH,GAASO,EAChBL,GAAgBK,EAKxB,OAAOJ,EAaX,SAASK,EAAuBd,GAI5B,OADiBD,EAAgBC,EAFpBpB,UAAUC,OAAS,QAAsBZ,IAAjBW,UAAU,GAAmBA,UAAU,GAAK,KAG/DK,IAAI,SAAUC,GAC5B,QAASA,IAiBjB,SAAS6B,EAAsBf,GAC3B,IAEIgB,EAAkBjB,EAAgBC,EAFzBpB,UAAUC,OAAS,QAAsBZ,IAAjBW,UAAU,GAAmBA,UAAU,GAAK,KAG7EqC,EAAaD,EAAgBlB,OAAO,SAAUhD,EAAGC,GACjD,OAAOD,EAAIC,GACZ,GACH,OAAOiE,EAAgB/B,IAAI,SAAUC,GACjC,OAAOA,EAAO+B,IAtGtBjF,OAAOC,eAAenB,EAAS,cAC3B2C,OAAO,IAGX,IAAImD,EAAiB,WAAwZ,OAAO,SAAUtB,EAAK/D,GAAK,GAAIuD,MAAMC,QAAQO,GAAQ,OAAOA,EAAY,GAAI4B,OAAOC,YAAYnF,OAAOsD,GAAQ,OAAxf,SAAuBA,EAAK/D,GAAK,IAAI6F,KAAeC,GAAK,EAAUC,GAAK,EAAWC,OAAKtD,EAAW,IAAM,IAAK,IAAiCuD,EAA7BC,EAAKnC,EAAI4B,OAAOC,cAAmBE,GAAMG,EAAKC,EAAGC,QAAQC,QAAoBP,EAAKQ,KAAKJ,EAAG/D,QAAYlC,GAAK6F,EAAKvC,SAAWtD,GAA3D8F,GAAK,IAAoE,MAAOQ,GAAOP,GAAK,EAAMC,EAAKM,EAAO,QAAU,KAAWR,GAAMI,EAAW,QAAGA,EAAW,SAAO,QAAU,GAAIH,EAAI,MAAMC,GAAQ,OAAOH,EAA6HU,CAAcxC,EAAK/D,GAAa,MAAM,IAAIwG,UAAU,yDAAjkB,GAsGjBrE,GAAWqC,gBAAiBA,EAAiBe,uBAAwBA,EAAwBC,sBAAuBA,GACxHjG,EAAQ6C,QAAUD,EAClB5C,EAAQiF,gBAAkBA,EAC1BjF,EAAQgG,uBAAyBA,EACjChG,EAAQiG,sBAAwBA","file":"gwas-credible-sets.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"gwasCredibleSets\"] = factory();\n\telse\n\t\troot[\"gwasCredibleSets\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 1);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/** @module stats */\n\n/**\n * The inverse of the CDF. May be used to determine the z-score for the desired quantile.\n *\n * This is an implementation of algorithm AS241:\n *     https://www.jstor.org/stable/2347330\n * @param {Number} p The desired quantile of the normal distribution\n * @returns {Number}\n */\nfunction ninv(p) {\n    var SPLIT1 = 0.425;\n    var SPLIT2 = 5.0;\n    var CONST1 = 0.180625;\n    var CONST2 = 1.6;\n    var a = [3.3871328727963666080E0, 1.3314166789178437745E2, 1.9715909503065514427E3, 1.3731693765509461125E4, 4.5921953931549871457E4, 6.7265770927008700853E4, 3.3430575583588128105E4, 2.5090809287301226727E3];\n\n    var b = [4.2313330701600911252E1, 6.8718700749205790830E2, 5.3941960214247511077E3, 2.1213794301586595867E4, 3.9307895800092710610E4, 2.8729085735721942674E4, 5.2264952788528545610E3];\n\n    var c = [1.42343711074968357734E0, 4.63033784615654529590E0, 5.76949722146069140550E0, 3.64784832476320460504E0, 1.27045825245236838258E0, 2.41780725177450611770E-1, 2.27238449892691845833E-2, 7.74545014278341407640E-4];\n\n    var d = [2.05319162663775882187E0, 1.67638483018380384940E0, 6.89767334985100004550E-1, 1.48103976427480074590E-1, 1.51986665636164571966E-2, 5.47593808499534494600E-4, 1.05075007164441684324E-9];\n\n    var e = [6.65790464350110377720E0, 5.46378491116411436990E0, 1.78482653991729133580E0, 2.96560571828504891230E-1, 2.65321895265761230930E-2, 1.24266094738807843860E-3, 2.71155556874348757815E-5, 2.01033439929228813265E-7];\n\n    var f = [5.99832206555887937690E-1, 1.36929880922735805310E-1, 1.48753612908506148525E-2, 7.86869131145613259100E-4, 1.84631831751005468180E-5, 1.42151175831644588870E-7, 2.04426310338993978564E-15];\n\n    var q = p - 0.5;\n    var r = void 0,\n        x = void 0;\n\n    if (Math.abs(q) < SPLIT1) {\n        r = CONST1 - q * q;\n        return q * (((((((a[7] * r + a[6]) * r + a[5]) * r + a[4]) * r + a[3]) * r + a[2]) * r + a[1]) * r + a[0]) / (((((((b[6] * r + b[5]) * r + b[4]) * r + b[3]) * r + b[2]) * r + b[1]) * r + b[0]) * r + 1.0);\n    } else {\n        if (q < 0) {\n            r = p;\n        } else {\n            r = 1.0 - p;\n        }\n\n        if (r > 0) {\n            r = Math.sqrt(-Math.log(r));\n            if (r <= SPLIT2) {\n                r -= CONST2;\n                x = (((((((c[7] * r + c[6]) * r + c[5]) * r + c[4]) * r + c[3]) * r + c[2]) * r + c[1]) * r + c[0]) / (((((((d[6] * r + d[5]) * r + d[4]) * r + d[3]) * r + d[2]) * r + d[1]) * r + d[0]) * r + 1.0);\n            } else {\n                r -= SPLIT2;\n                x = (((((((e[7] * r + e[6]) * r + e[5]) * r + e[4]) * r + e[3]) * r + e[2]) * r + e[1]) * r + e[0]) / (((((((f[6] * r + f[5]) * r + f[4]) * r + f[3]) * r + f[2]) * r + f[1]) * r + f[0]) * r + 1.0);\n            }\n        } else {\n            throw 'Not implemented';\n        }\n\n        if (q < 0) {\n            x = -x;\n        }\n\n        return x;\n    }\n}\n\n// Hack: A single global object representing the contents of the module\nvar rollup = { ninv: ninv };\n\nexports.ninv = ninv;\nexports.default = rollup;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.marking = exports.stats = exports.scoring = undefined;\n\nvar _stats = __webpack_require__(0);\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nvar _scoring = __webpack_require__(2);\n\nvar _scoring2 = _interopRequireDefault(_scoring);\n\nvar _marking = __webpack_require__(3);\n\nvar _marking2 = _interopRequireDefault(_marking);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// HACK: Because a primary audience is targets that do not have any module system, we will expose submodules from the\n//  top-level module. (by representing each sub-module as a \"rollup object\" that exposes its internal methods)\n// Then, submodules may be accessed as `window.gwasCredibleSets.stats`, etc\n\n// If you are using a real module system, please import from sub-modules directly- these global helpers are a bit of\n//  a hack and may go away in the future\nexports.scoring = _scoring2.default;\nexports.stats = _stats2.default;\nexports.marking = _marking2.default; /** @module gwas-credible-sets */\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports._nlogp_to_z2 = exports.posteriorProbabilities = exports.bayesFactors = undefined;\n\nvar _stats = __webpack_require__(0);\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } } /** @module scoring */\n\n/**\n * Convert a -logp value to Z^2.\n *\n * Very large -logp (very small p values) cannot be converted to z by a direct method. These values\n *  are handled using an approximation: for small p-values, Z_i^2 has a linear relationship with -log10 p-value.\n *\n *  The cutoff on pvalues is ~ 10^-325\n *\n * @param nlogp\n * @return {number}\n * @private\n */\nfunction _nlogp_to_z2(nlogp) {\n    var p = Math.pow(10, -nlogp);\n    if (nlogp < 300) {\n        // Use exact method when within the range of 64-bit floats (approx 10^-323)\n        return Math.pow((0, _stats.ninv)(p / 2), 2);\n    } else {\n        // For very small p-values, -log10(pval) and z^2 have a linear relationship\n        // This avoids issues with needing higher precision floats when doing the calculation\n        // with ninv\n        return 4.59884133027944 * nlogp - 5.88085867031722;\n    }\n}\n\n/**\n * Calculate a probability statistic exp(Z^2 / 2) based on pvalues. If the Z-score is very large, the bayes factors\n *  can be calculated in an inexact (capped) manner that makes the calculation tractable but preserves comparisons\n * @param {Number[]} nlogpvals An array of -log(pvalue) entries\n * @param {Boolean} [cap=true] Whether to apply an inexact method. If false, some values in the return array may\n *  be represented as \"Infinity\", but the bayes factors will be directly calculated wherever possible.\n * @return {Number[]} An array of exp(Z^2 / 2) statistics\n */\nfunction bayesFactors(nlogpvals) {\n    var cap = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n    if (!Array.isArray(nlogpvals) || !nlogpvals.length) {\n        throw 'Must provide a non-empty array of pvalues';\n    }\n\n    // 1. Convert the pvalues to Z^2 / 2 values. Divide by 2 before applying the cap, because it means fewer values will\n    //   need to be truncated. This does affect some of the raw bayes factors that are returned (when a cap is needed),\n    //   but the resulting credible set contents / posterior probabilities are unchanged.\n    var z2_2 = nlogpvals.map(function (item) {\n        return _nlogp_to_z2(item) / 2;\n    });\n\n    // 2. Calculate bayes factor, using a truncation approach that prevents overrunning the max float64 value for e**x\n    //   (when x > 709 or so). As safeguard, we could (but currently don't) check that exp(x) is not larger\n    //   than infinity.\n    if (cap) {\n        var capValue = Math.max.apply(Math, _toConsumableArray(z2_2)) - 708; // The real cap is ~709; this should prevent any value from exceeding it\n        if (capValue > 0) {\n            z2_2 = z2_2.map(function (item) {\n                return item - capValue;\n            });\n        }\n    }\n    return z2_2.map(function (item) {\n        return Math.exp(item);\n    });\n}\n\n/**\n * Convert an array of raw per-element probability scores into posterior probabilities, dividing by the sum of all\n *   elements in the range.\n *\n * This is a helper function for visualization and analysis; most of the methods in this library will convert raw\n * scores to posterior probabilities internally.\n * @param {Number[]} scores An array of probability scores for all elements in the range\n * @returns {Number[]} Posterior probabilities\n */\nfunction posteriorProbabilities(scores) {\n    var sumValues = scores.reduce(function (a, b) {\n        return a + b;\n    }, 0);\n    return scores.map(function (item) {\n        return item / sumValues;\n    });\n}\n\nvar rollup = { bayesFactors: bayesFactors, posteriorProbabilities: posteriorProbabilities };\nexports.default = rollup;\nexports.bayesFactors = bayesFactors;\nexports.posteriorProbabilities = posteriorProbabilities;\n\n// Export additional symbols for unit testing only (not part of public interface for the module)\n\nexports._nlogp_to_z2 = _nlogp_to_z2;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\n/** @module marking */\n\n/**\n * Given a set of raw per-element score statistics, determine which contribute most to total posterior probability,\n * and are thus members of the credible set.\n * @param {Number[]} statistics Calculated statistics used to rank the credible set (eg raw bayes factors)\n * @param {Number} [cutoff=0.95] Keep taking items until we have accounted for >= this fraction of the total probability\n * @return {Number[]} An array with posterior probabilities (for the items in the credible set), and zero for all\n *   other elements\n *  This array should be the same length as the provided statistic array\n */\nfunction findCredibleSet(statistics) {\n    var cutoff = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0.95;\n\n    // Type checking\n    if (!Array.isArray(statistics) || !statistics.length) {\n        throw 'Statistics must be a non-empty array';\n    }\n    if (!(typeof cutoff === 'number') || cutoff < 0 || cutoff > 1.0 || Number.isNaN(cutoff)) {\n        throw 'Cutoff must be a number between 0 and 1';\n    }\n\n    var statsTotal = statistics.reduce(function (a, b) {\n        return a + b;\n    }, 0);\n    if (statsTotal <= 0) {\n        throw 'Sum of provided statistics must be > 0';\n    }\n\n    // Sort the statistics by largest first, while preserving a map to original item order\n    var sortedStatsMap = statistics.map(function (item, index) {\n        return [item, index];\n    }).sort(function (a, b) {\n        return b[0] - a[0];\n    });\n\n    var runningTotal = 0;\n    var result = new Array(sortedStatsMap.length).fill(0);\n    for (var i = 0; i < sortedStatsMap.length; i++) {\n        var _sortedStatsMap$i = _slicedToArray(sortedStatsMap[i], 2),\n            value = _sortedStatsMap$i[0],\n            index = _sortedStatsMap$i[1];\n\n        if (runningTotal < cutoff) {\n            // Convert from a raw score to posterior probability by dividing the item under consideration\n            //  by sum of all probabilities.\n            var score = value / statsTotal;\n            result[index] = score;\n            runningTotal += score;\n        } else {\n            break;\n        }\n    }\n    return result;\n}\n\n/**\n * Analyze a set of probabilities and return booleans indicating which items contribute to the credible set.\n *\n * This is a helper method for, eg, visualizing the members of the credible set by raw membership.\n *\n * @param {Number[]} statistics Calculated statistics used to rank the credible set (eg raw bayes factors)\n * @param {Number} [cutoff=0.95] Keep taking items until we have accounted for >= this fraction of the total probability\n * @return {Boolean[]} An array of booleans identifying whether or not each item is in the credible set\n *  This array should be the same length as the provided statistics array\n */\nfunction markCredibleSetBoolean(statistics) {\n    var cutoff = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0.95;\n\n    var setMembers = findCredibleSet(statistics, cutoff);\n    return setMembers.map(function (item) {\n        return !!item;\n    });\n}\n\n/**\n * Analyze a set of probabilities and return a fraction saying how much each item contributes to the credible set.\n *   For example, if a single item accounts for 96% of total probabilities, then for the 95% credible set,\n *   that item would be scaled to \"1.0\" (because it alone represents the entire credible set and then some).\n *\n * This is a helper method for, eg, visualizing the relative significance of contributions to the credible set.\n *   For example, when a gradient must be specified in advance and is not auto-determined by the range of the data.\n *\n * @param {Number[]} statistics Calculated statistics used to rank the credible set (eg raw bayes factors)\n * @param {Number} [cutoff=0.95] Keep taking items until we have accounted for >= this fraction of the total probability\n * @return {Number[]} An array of numbers representing the fraction of credible set probabilities this item accounts for.\n *  This array should be the same length as the provided statistics array\n */\nfunction markCredibleSetScaled(statistics) {\n    var cutoff = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0.95;\n\n    var setMemberScores = findCredibleSet(statistics, cutoff);\n    var sumMarkers = setMemberScores.reduce(function (a, b) {\n        return a + b;\n    }, 0);\n    return setMemberScores.map(function (item) {\n        return item / sumMarkers;\n    });\n}\n\nvar rollup = { findCredibleSet: findCredibleSet, markCredibleSetBoolean: markCredibleSetBoolean, markCredibleSetScaled: markCredibleSetScaled };\nexports.default = rollup;\nexports.findCredibleSet = findCredibleSet;\nexports.markCredibleSetBoolean = markCredibleSetBoolean;\nexports.markCredibleSetScaled = markCredibleSetScaled;\n\n/***/ })\n/******/ ]);\n});\n//# sourceMappingURL=gwas-credible-sets.js.map"]}